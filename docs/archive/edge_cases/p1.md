# Serbian Inflector Edge Case Discovery Prompt

## Context

You are testing a Serbian word inflection system implemented in Elixir. The system consists of six inflector modules that generate declined/conjugated forms of Serbian words:

- **Nouns** (`Ohmyword.Linguistics.Nouns`) - 14 forms (7 cases × 2 numbers)
- **Verbs** (`Ohmyword.Linguistics.Verbs`) - 16+ forms (infinitive, present, past participle, imperative)
- **Adjectives** (`Ohmyword.Linguistics.Adjectives`) - 84+ forms (indefinite/definite × cases × genders × numbers)
- **Pronouns** (`Ohmyword.Linguistics.Pronouns`) - variable forms including clitics
- **Numerals** (`Ohmyword.Linguistics.Numerals`) - variable based on value (1-4 decline, 5+ invariable)
- **Invariables** (`Ohmyword.Linguistics.Invariables`) - adverbs (with optional comparison), prepositions, conjunctions, particles, interjections

## Your Task

Generate comprehensive edge cases that might break the inflection logic. For each edge case, provide:

1. **Word struct** - The exact input data
2. **Expected behavior** - What should happen
3. **Potential failure mode** - What might go wrong
4. **Category** - Type of edge case (linguistic, input validation, encoding, etc.)

---

## Edge Case Categories to Explore

### 1. NOUNS - Declension Edge Cases

#### 1.1 Fleeting Vowel A

The fleeting "a" disappears when endings are added (pas → psa), but returns in genitive plural (pasa).

**Test these cases:**
- Words where fleeting A is in different positions: `vrabac` (sparrow), `borac` (fighter), `otac` (father)
- Words with multiple potential "a" positions: what happens?
- Very short words with fleeting A: `san` (dream) → `sna` - is the algorithm handling 3-letter words?
- What if `fleeting_a: true` is set but no "a" exists between consonants?

#### 1.2 Palatalization in Vocative

Consonant changes: k→č, g→ž, h→š, c→č, z→ž

**Test these cases:**
- What happens with digraphs before palatalization? `vojnik` → `vojniče` (the k changes, not the n)
- What about words ending in double consonants?
- What if palatalization flag is true but the word doesn't end in a palatalizable consonant?
- What about `brat` (brother)? No palatalization expected, but often confused

#### 1.3 Plural Formation

**Test these cases:**
- Masculine nouns that take -i plural without -ov-/-ev-: `zub` (tooth) → `zubi` not `zubovi`
- Nouns ending in soft consonants (č, ć, ž, š, đ, dž, j, lj, nj): should use -ev- not -ov-
- What about `muž` (husband) → `muževi`? Is digraph `ž` detected correctly?

#### 1.4 Animacy Edge Cases

**Test these cases:**
- Masculine noun with `animate: nil` instead of true/false
- Feminine/neuter nouns - animacy should be ignored, but what if accidentally set?
- Abstract masculine nouns that could be interpreted either way: `narod` (nation/people)

#### 1.5 Irregular Forms

**Test these cases:**
- `čovek` with `irregular_plural: "ljudi"` - all plural forms should use this stem
- `oko` (eye) with `irregular_forms: %{"gen_pl" => "očiju"}` - other forms should be regular
- What if `irregular_forms` contains a typo in the key? (e.g., "gen_pll" instead of "gen_pl")

#### 1.6 Special Noun Types

**Test these cases:**
- Singularia tantum: `mleko` (milk), `ljubav` (love) - should return only 7 forms
- Pluralia tantum: `novine` (newspaper), `pantalone` (pants) - should return only 7 forms
- What if both flags are set? (invalid state)

#### 1.7 Declension Class Inference

**Test these cases:**
- Noun with `declension_class: nil` - should infer from gender + ending
- Masculine noun ending in -a: `tata` (dad) - should use a-stem, not consonant
- Neuter noun ending in consonant: rare, but what happens?
- Noun with invalid declension_class string: `"invalid-class"`

---

### 2. VERBS - Conjugation Edge Cases

#### 2.1 Stem Extraction

**Test these cases:**
- Verbs ending in -ći: `moći` (can), `ići` (go) - stem extraction different from -ti verbs
- Very short verbs: `ići` → stem is just "i"?
- What about `doći`, `naći`, `otići`? Prefixed -ći verbs

#### 2.2 Present Stem Override

**Test these cases:**
- E-verb without `present_stem` in metadata - this is supposed to be required!
- `pisati` with `present_stem: "piš"` - should produce `pišem`, `pišeš`, etc.
- What if `present_stem` is empty string `""`?

#### 2.3 Reflexive Verbs

**Test these cases:**
- `smejati se` - all forms should include " se"
- What if `reflexive: true` but term doesn't contain " se"?
- What if term has "se" but `reflexive: false`?
- Nested reflexive: `smejati se se` (malformed input)

#### 2.4 Past Participle Formation

**Test these cases:**
- Verbs where stem ends in vowel: `čitati` → `čita-` → `čitao` (not `čitaao`)
- Verbs where stem ends in consonant: need -ao, not just -o
- `biti` → `bio` - highly irregular, is it handled by override?

#### 2.5 Imperative Formation

**Test these cases:**
- A-verbs with vowel-ending stem: should use -j, -jmo, -jte
- E-verbs/I-verbs: should use -i, -imo, -ite
- What happens if conjugation_class is nil?

#### 2.6 Highly Irregular Verbs

**Test these cases:**
- `biti` (to be) - present tense is completely irregular (sam, si, je, smo, ste, su)
- `hteti` (to want) - has both full and clitic forms (hoću vs ću)
- `moći` (can) - stem changes between forms (mogu, možeš)
- Are these handled via `irregular_forms` in metadata, or hardcoded?

#### 2.7 Impersonal Verbs

**Test these cases:**
- `trebati` with `impersonal: true` - does it generate only 3rd person?
- What's the expected behavior if impersonal flag is set?

---

### 3. ADJECTIVES - Declension Edge Cases

#### 3.1 Soft Stem Detection

**Test these cases:**
- Adjectives ending in digraphs: `svež` (fresh), `vrući` (hot)
- What about `lj`, `nj`, `dž` as final digraph?
- What if `soft_stem: true` is set but stem ends in hard consonant?

#### 3.2 Fleeting A in Adjectives

**Test these cases:**
- `dobar` (good) → `dobra`, `dobro` (the A disappears)
- `kratak` (short) → `kratka` (same pattern)
- What if fleeting_a is set but no eligible A exists?

#### 3.3 Indefinite vs Definite Forms

**Test these cases:**
- The key difference is masculine nominative singular: `nov` (indef) vs `novi` (def)
- Adjective with `no_short_form: true` - should skip indefinite forms
- What if the citation form already ends in -i? Is it treated as definite?

#### 3.4 Animacy in Masculine Accusative

**Test these cases:**
- Adjectives should follow the noun's animacy, but `word.animate` is for the adjective itself
- What happens when animacy is nil?
- Does the system generate both animate and inanimate forms, or just one?

#### 3.5 Comparative and Superlative

**Test these cases:**
- Regular comparative: `nov` → `noviji` - is this auto-generated?
- Irregular comparative: `dobar` → `bolji` via `comparative_stem: "bolj"`
- Superlative from comparative: `bolji` → `najbolji` (prefix naj-)
- What if `superlative_stem` is provided but not `comparative_stem`?

#### 3.6 Indeclinable Adjectives

**Test these cases:**
- Foreign adjectives: `bež` (beige), `fer` (fair) - return only base form
- What if `indeclinable: true` but word has normal Serbian ending?

---

### 4. PRONOUNS - Paradigm Edge Cases

#### 4.1 Personal Pronouns

**Test these cases:**
- `ja`, `ti`, `on`, `ona`, `ono`, `mi`, `vi`, `oni` - all hardcoded paradigms
- What about `one` (they, feminine)? `ona` (they, neuter)?
- Clitic forms: `me`, `te`, `ga`, `je`, `nam`, `vam`, `ih` - are all generated?

#### 4.2 Possessive Pronouns

**Test these cases:**
- `moj`, `tvoj`, `svoj` - have contracted forms (`mog` not `mojog`)
- `naš`, `vaš`, `njegov`, `njen`, `njihov` - regular adjective-like declension
- What if possessive pronoun is not in the hardcoded list?

#### 4.3 Demonstrative Pronouns

**Test these cases:**
- `ovaj`, `taj`, `onaj` - stem extraction (ov-, t-, on-)
- Neuter forms: `ovo`, `to`, `ono` - different from masculine
- What about `ovakav`, `takav`, `onakav`? Different pattern?

#### 4.4 Interrogative Pronouns

**Test these cases:**
- `ko` (who) → `koga`, `kome`, `kim` - fully irregular
- `šta` vs `što` - both variants exist in Serbian
- `koji`, `čiji` - adjective-like declension, soft stems
- `kakav` - has fleeting A: `kakav` → `kakva`, `kakvo`

#### 4.5 Derived Pronouns

**Test these cases:**
- `neko` (someone) - derived from `ko` with prefix
- `nešto` (something) - derived from `šta` but different pattern (`ne-` + č- forms)
- `niko`, `ništa` - negative pronouns, same pattern
- `svako`, `nešto`, `iko`, `išta` - are these supported?

#### 4.6 Manual Forms Flag

**Test these cases:**
- Pronoun with `manual_forms_only: true` but term not in hardcoded paradigms
- What happens if the flag is not set for a highly irregular pronoun?

---

### 5. NUMERALS - Special Cases

#### 5.1 Cardinal 1-4

**Test these cases:**
- `jedan` - full adjectival declension with gender
- `dva` - gender forms (dva/dve) plus partial declension
- `tri`, `četiri` - no gender, partial declension
- What about `oba`/`obe` (both)? Similar to `dva`

#### 5.2 Cardinals 5+

**Test these cases:**
- `pet`, `šest`, `sedam`, etc. - should return only base form
- `deset`, `dvadeset`, `sto` - invariable?
- What if `declines: true` is incorrectly set for an invariable numeral?

#### 5.3 Ordinal Numerals

**Test these cases:**
- `prvi` (1st), `drugi` (2nd) - adjective-like declension
- `treći` (3rd) - soft stem (ć), different neuter ending
- What if ordinal's stem is incorrectly extracted? `treći` → stem should be `treć-`

#### 5.4 Collective Numerals

**Test these cases:**
- `dvoje`, `troje`, `četvoro`, `petoro` - special declension paradigm
- Unknown collective not in hardcoded paradigms - what happens?

#### 5.5 Numeral Type Inference

**Test these cases:**
- Numeral without `numeral_type` in metadata - should infer from term
- What if inference fails? (unknown numeral)

---

### 6. INVARIABLES - Simple but Tricky

#### 6.1 Adverbs with Comparison

**Test these cases:**
- `brzo` with `comparative: "brže"`, `superlative: "najbrže"` - should return 3 forms
- Irregular comparison: `dobro` → `bolje` → `najbolje`
- What if only `comparative` is provided but not `superlative`?
- What if values are empty strings?

#### 6.2 Prepositions

**Test these cases:**
- Single-letter prepositions: `u`, `s`, `k` - edge case for string operations
- Multi-word prepositions: `bez obzira na` - stored and returned as-is?

#### 6.3 Conjunctions and Particles

**Test these cases:**
- Very short words: `i`, `a`, `ne`, `da`
- These should simply return `[{term, "base"}]`

---

### 7. CROSS-CUTTING EDGE CASES

#### 7.1 Nil and Empty Handling

**Test these cases:**
- `word.term` is nil
- `word.term` is empty string `""`
- `word.part_of_speech` is nil
- `word.grammar_metadata` is nil

#### 7.2 Character Encoding

**Test these cases:**
- Serbian diacritics: č, ć, đ, š, ž - are they handled correctly?
- Uppercase input: `PAS` instead of `pas` - should output be lowercase?
- Mixed case: `Pas`, `PaS` - normalized?

#### 7.3 Digraph Handling

**Test these cases:**
- Words ending in digraphs: `lj`, `nj`, `dž`
- Digraphs in the middle: `prijatelj` (friend) - is `lj` detected as single unit?
- Fleeting A removal near digraphs

#### 7.4 Metadata Keys

**Test these cases:**
- Metadata keys with typos: `"fleting_a"` instead of `"fleeting_a"`
- String vs atom keys: `%{fleeting_a: true}` vs `%{"fleeting_a" => true}`
- Nested metadata: `%{"irregular_forms" => %{"gen_pl" => "očiju"}}`

#### 7.5 Part of Speech Boundaries

**Test these cases:**
- What if a word is miscategorized? (noun marked as verb)
- What if `part_of_speech` is an unrecognized atom like `:unknown`?

#### 7.6 Extremely Long Words

**Test these cases:**
- Very long compound words: `protivustavnozakonodavstvo` (anti-constitutional lawmaking)
- Do string operations handle long inputs?

#### 7.7 Invalid Combinations

**Test these cases:**
- Masculine noun without `animate` field
- Verb without `conjugation_class` - what's the default behavior?
- Adjective marked as indeclinable but with `comparative_stem` set

---

## Output Format

For each edge case you discover, format it as:

```elixir
# Edge Case: [Brief description]
# Category: [linguistic/validation/encoding/boundary/etc.]
# Expected: [What should happen]
# Risk: [What might break]

%Ohmyword.Vocabulary.Word{
  term: "example",
  part_of_speech: :noun,
  gender: :masculine,
  animate: true,
  declension_class: "consonant",
  grammar_metadata: %{
    "fleeting_a" => true
  }
}
```

## Priority Order

Focus first on:
1. **Linguistic edge cases** - Actual Serbian language exceptions
2. **Input validation** - Nil, empty, invalid values
3. **Boundary conditions** - Very short/long words, digraphs
4. **Metadata handling** - Missing keys, wrong types

---

## Additional Notes

- The system stores all data in **Latin script** (not Cyrillic)
- Output forms should always be **lowercase**
- The system uses **Elixir structs** with atom keys for schema fields, but **string keys** for `grammar_metadata`
- Forms are returned as `[{term, form_tag}]` tuples

Generate at least 50 specific edge case inputs that could reveal bugs in the inflection logic.
